(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e1f78644"],{"0275":function(t,e,s){"use strict";s("7f7f");var a=s("2fa3");e["a"]={getOrder:function(){return a["b"].get("/orderEdit")},postOrder:function(t){var e=t.amount,s=t.UserId,r=t.StoreId,i=t.name,n=t.address,o=t.phone,c=t.shipmentType,l=t.paymentType,p=t.cartId,d=t.couponId;return a["b"].post("/order",{amount:e,UserId:s,StoreId:r,name:i,address:n,phone:o,shipmentType:c,paymentType:l,cartId:p,couponId:d})},getOrderSuccess:function(t){var e=t.orderId;return a["b"].get("/order/".concat(e,"/success"),{orderId:e})},getPayment:function(t){var e=t.orderId;return a["b"].get("/order/".concat(e,"/payment"),{orderId:e})},getBranchSelection:function(t){var e=t.orderId;return a["b"].get("/order/".concat(e,"/branchselection"),{orderId:e})},cancelOrder:function(t){var e=t.orderId;return a["b"].post("/order/".concat(e),{orderId:e})}}},"086c":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mt-5"},[s("form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[t._m(0),s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-7"},[s("div",{staticClass:"mt-5"},[s("h4",[t._v("購買人資訊：")]),s("div",{staticClass:"form_group row mt-5"},[s("label",{staticClass:"col-2"},[t._v("名字:")]),s("div",{staticClass:"col-10"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.name,expression:"user.name"}],staticClass:"form-control",attrs:{type:"text",name:"name",required:""},domProps:{value:t.user.name},on:{input:function(e){e.target.composing||t.$set(t.user,"name",e.target.value)}}})])]),s("div",{staticClass:"form-group row mt-4"},[s("label",{staticClass:"col-2"},[t._v("電話:")]),s("div",{staticClass:"col-10"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.phone,expression:"user.phone"}],staticClass:"form-control",attrs:{type:"tel",name:"phone",required:""},domProps:{value:t.user.phone},on:{input:function(e){e.target.composing||t.$set(t.user,"phone",e.target.value)}}})])]),s("div",{staticClass:"form-group row mt-4"},[s("label",{staticClass:"col-2"},[t._v("地址:")]),s("div",{staticClass:"col-10"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.user.address,expression:"user.address"}],staticClass:"form-control",attrs:{type:"address",name:"address",rows:"5",required:""},domProps:{value:t.user.address},on:{input:function(e){e.target.composing||t.$set(t.user,"address",e.target.value)}}})])])])]),s("div",{staticClass:"col-lg-5"},[s("div",{staticClass:"mt-5"},[s("h4",[t._v("運送與付款方式：")]),s("div",{staticClass:"form-group mt-5"},[s("label",{staticClass:"col-md-5"},[t._v("運送方式:")]),s("div",{staticClass:"col-md-10 mt-3"},[s("label",{staticClass:"radio-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.shipmentType,expression:"shipmentType"}],staticClass:"home",attrs:{type:"radio",name:"shipmentType",value:"1"},domProps:{checked:t._q(t.shipmentType,"1")},on:{change:function(e){t.shipmentType="1"}}}),t._v(" 宅配\n              ")]),s("label",{staticClass:"radio-inline"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.shipmentType,expression:"shipmentType"}],staticClass:"pick-up",attrs:{type:"radio",name:"shipmentType",value:"2"},domProps:{checked:t._q(t.shipmentType,"2")},on:{change:function(e){t.shipmentType="2"}}}),t._v(" 超商取貨\n              ")])])]),s("div",{staticClass:"form-group mt-5"},[s("label",{staticClass:"col-md-5"},[t._v("付款方式:")]),s("div",{staticClass:"col-md-10 mt-3"},[this.shipmentType===this.creditCard?s("label",{staticClass:"radio-inline",attrs:{id:"payment"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentType,expression:"paymentType"}],staticClass:"payment",attrs:{type:"radio",name:"paymentType",value:"2",disabled:""},domProps:{checked:t._q(t.paymentType,"2")},on:{change:function(e){t.paymentType="2"}}}),t._v(" 線上支付\n              ")]):s("label",{staticClass:"radio-inline",attrs:{id:"payment"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentType,expression:"paymentType"}],staticClass:"payment",attrs:{type:"radio",name:"paymentType",value:"1"},domProps:{checked:t._q(t.paymentType,"1")},on:{change:function(e){t.paymentType="1"}}}),t._v(" 線上支付\n              ")]),s("label",{staticClass:"radio-inline ml-3"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentType,expression:"paymentType"}],attrs:{type:"radio",name:"paymentType",value:"2"},domProps:{checked:t._q(t.paymentType,"2")},on:{change:function(e){t.paymentType="2"}}}),t._v(" 貨到付款\n              ")])])])])])]),s("div",{staticClass:"form-group mt-4 row"},[s("p",{staticClass:"col"},[t._v(" ")]),s("input",{attrs:{type:"hidden",name:"cartId"},domProps:{value:t.cart.id}}),s("input",{attrs:{type:"hidden",name:"amount"},domProps:{value:t.totalPrice}}),t.couponId?s("input",{attrs:{type:"hidden",name:"couponId"},domProps:{value:t.couponId}}):t._e(),s("input",{attrs:{type:"hidden",name:"shipping_status",value:"0"}}),s("input",{attrs:{type:"hidden",name:"payment_status",value:"0"}}),s("input",{attrs:{type:"hidden",name:"StoreId"},domProps:{value:t.user.StoreId}}),s("button",{staticClass:"btn btn-success",attrs:{type:"submit",disabled:t.isProcessing}},[t._v("前往結帳")])])])])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"orderNav col-12 mt-3"},[s("h3",{staticClass:"d-inline text-white"},[t._v(" 選擇您的付款與運送方式 ")])])}],i=(s("7f7f"),s("96cf"),s("3b8d")),n=(s("c5f6"),s("0275")),o=s("2fa3"),c={props:{user:{type:Object,required:!0},cart:{type:Object,required:!0},totalPrice:{type:Number,default:-1},couponId:{type:Number}},data:function(){return{name:"",phone:"",address:"",shipmentType:-1,paymentType:-1,creditCard:"2",isProcessing:!1}},methods:{handleSubmit:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.isProcessing=!0,t.next=4,n["a"].postOrder({amount:this.totalPrice,StoreId:this.user.StoreId,name:this.user.name,address:this.user.address,phone:this.user.phone,shipmentType:this.shipmentType,paymentType:this.paymentType,cartId:this.cart.id,couponId:this.couponId});case 4:if(e=t.sent,s=e.data,a=e.statusText,"OK"===a&&"success"===s.status){t.next=9;break}throw new Error(a);case 9:this.isProcessing=!1,localStorage.setItem("cartItemNumber",0),this.$store.commit("setCartItemNumber"),o["a"].fire({type:"success",title:"已成功建立訂單"}),"1"===this.paymentType?this.$router.push("order/".concat(s.order.id,"/payment")):"2"===this.shipmentType?this.$router.push("order/".concat(s.order.id,"/branchselection")):this.$router.push("order/".concat(s.order.id,"/success")),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](0),this.isProcessing=!1,o["a"].fire({type:"error",title:"無法建立訂單，請稍後再試"});case 20:case"end":return t.stop()}}),t,this,[[0,16]])})));function e(){return t.apply(this,arguments)}return e}()}},l=c,p=(s("810b"),s("2877")),d=Object(p["a"])(l,a,r,!1,null,"8fbb0eee",null);e["a"]=d.exports},"2cf6":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"table"},[t._m(0),s("tbody",t._l(t.items,(function(e){return s("tr",{key:e.id},[s("td",[s("div",{staticStyle:{display:"flow-root"}},[s("img",{staticClass:"card-img",attrs:{src:e.image,alt:"..."}}),s("span",{staticClass:"item-name"},[t._v(t._s(e.name))])])]),s("td",[s("p",{staticClass:"mt-2"},[s("span",{staticClass:"money-symbol"},[t._v("$")]),t._v("\n          "+t._s(e.price)+"\n        ")])]),s("td",[s("p",{staticClass:"mt-2"},[t._v(" "+t._s(e.Cart_item.quantity))])]),s("td",[s("p",{staticClass:"mt-2"},[s("span",{staticClass:"money-symbol"},[t._v("$")]),t._v("\n          "+t._s(e.price*e.Cart_item.quantity)+"\n        ")])])])})),0)])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("商品")]),s("th",[t._v("價格")]),s("th",[t._v("數量")]),s("th",[t._v("小計")])])])}],i={props:{items:{type:Array,required:!0}}},n=i,o=(s("48c6"),s("2877")),c=Object(o["a"])(n,a,r,!1,null,"15f9f742",null);e["a"]=c.exports},"3ea7":function(t,e,s){},"48c6":function(t,e,s){"use strict";var a=s("c4ab"),r=s.n(a);r.a},"4b19":function(t,e,s){},"5d80":function(t,e,s){"use strict";var a=s("79d4"),r=s.n(a);r.a},"79d4":function(t,e,s){},"7b37":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container mb-5"},[t.isLoading?s("Spinner"):[s("div",{staticClass:"order-box row"},[s("div",{staticClass:"row step col-12"},[s("div",{staticClass:"col-3 text-center"},[s("span",{staticClass:"step-by-step bg-secondary rounded-pill text-dark d-inline-block"},[t._v("Step 1")]),s("p",{staticClass:"step-text text-dark"},[t._v("確認購物車")])]),s("div",{staticClass:"arrow col-1"},[s("i",{staticClass:"fas fa-long-arrow-alt-right"})]),s("div",{staticClass:"col-3 text-center step-point-line step-point"},[s("span",{staticClass:"step-by-step border bg-dark rounded-pill text-light d-inline-block"},[t._v("Step 2")]),s("p",{staticClass:"step-text text-dark"},[t._v("付款與運送方式")])]),s("div",{staticClass:"arrow col-1",staticStyle:{color:"gray"}},[s("i",{staticClass:"fas fa-long-arrow-alt-right"})]),s("div",{staticClass:"col-3 text-center"},[s("span",{staticClass:"step-by-step border bg-secondary rounded-pill text-dark d-inline-block"},[t._v("Step 3")]),s("p",{staticClass:"step-text text-dark"},[t._v("成立訂單")])])])]),s("div",{staticClass:"orderNav row text-white mt-3 col-12"},[s("h3",[t._v(" 訂單明細")])]),this.items.length>0?s("OrderItems",{attrs:{items:t.items}}):t._e(),s("hr"),s("CartAmount",{attrs:{"total-price":t.totalPrice,"shipping-fee":t.shippingFee,subtotal:t.subtotal}}),s("SelectPaymentTransport",{attrs:{user:t.user,cart:t.cart,"total-price":t.totalPrice,couponId:t.couponId}})]],2)},r=[],i=(s("8e6e"),s("ac6a"),s("456d"),s("96cf"),s("3b8d")),n=s("bd86"),o=s("2cf6"),c=s("94e4"),l=s("086c"),p=s("2375"),d=s("0275"),u=s("2fa3"),m=s("2f62");function v(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function h(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?v(s,!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):v(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var y={components:{OrderItems:o["a"],CartAmount:c["a"],SelectPaymentTransport:l["a"],Spinner:p["a"]},data:function(){return{cart:{id:-1},totalPrice:-1,shippingFee:-1,subtotal:-1,items:[],user:{},couponId:0,isLoading:!0}},computed:h({},Object(m["b"])(["currentUser","isAuthenticated"])),created:function(){this.fetchOrder()},methods:{fetchOrder:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d["a"].getOrder();case 3:if(e=t.sent,s=e.data,a=e.statusText,"OK"===a){t.next=8;break}throw new Error(a);case 8:this.cart=s.cart,this.items=s.cart.items,this.totalPrice=s.totalPrice,this.shippingFee=s.shippingFee,this.subtotal=s.subtotal,this.user=s.user,this.isLoading=!1,t.next=21;break;case 17:t.prev=17,t.t0=t["catch"](0),this.isLoading=!1,u["a"].fire({type:"error",title:"無法取得訂單資料，請稍後再試"});case 21:case"end":return t.stop()}}),t,this,[[0,17]])})));function e(){return t.apply(this,arguments)}return e}()}},f=y,b=(s("c236"),s("2877")),C=Object(b["a"])(f,a,r,!1,null,"1ad30fdf",null);e["default"]=C.exports},"810b":function(t,e,s){"use strict";var a=s("4b19"),r=s.n(a);r.a},"94e4":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg-light text-dark"},[s("div",{staticClass:"row col-lg-8"},[s("div",{staticClass:"col"},[t._v("商品金額總計:")]),s("div",{staticClass:"amount"},[t._v(t._s(t.totalPrice)+" 元")])]),s("div",{staticClass:"row col-lg-8"},[s("div",{staticClass:"col"},[t._v("運費:")]),s("div",{staticClass:"amount"},[t._v(t._s(t.shippingFee)+" 元")])]),s("div",{staticClass:"row col-lg-8"},[s("div",{staticClass:"col"},[t._v("折價券折抵:")]),t.coupon?s("div",{staticClass:"amount"},[t._v("- "+t._s(t.coupon.discount)+" 元")]):s("div",{staticClass:"amount",staticStyle:{float:"right"}},[t._v("0 元")])]),s("div",{staticClass:"row col-lg-8"},[s("div",{staticClass:"col"},[t._v("金額總計:")]),t.coupon?s("div",{staticClass:"amount"},[t._v(t._s(t.subtotal-t.coupon.discount)+" 元")]):s("div",{staticClass:"amount",staticStyle:{float:"right"}},[t._v(t._s(t.subtotal)+" 元")])])])},r=[],i=(s("c5f6"),{props:{coupon:{type:Object},totalPrice:{type:Number,default:-1},shippingFee:{type:Number,default:-1},subtotal:{type:Number,default:-1}}}),n=i,o=(s("5d80"),s("2877")),c=Object(o["a"])(n,a,r,!1,null,"d805a62a",null);e["a"]=c.exports},c236:function(t,e,s){"use strict";var a=s("3ea7"),r=s.n(a);r.a},c4ab:function(t,e,s){}}]);
//# sourceMappingURL=chunk-e1f78644.558199e0.js.map