(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c804795e"],{"5d80":function(t,e,r){"use strict";var a=r("79d4"),s=r.n(a);s.a},"79d4":function(t,e,r){},"7a79":function(t,e,r){"use strict";var a=r("7eca"),s=r.n(a);s.a},"7eca":function(t,e,r){},"94e4":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"bg-light text-dark"},[r("div",{staticClass:"row col-lg-8"},[r("div",{staticClass:"col"},[t._v("商品金額總計:")]),r("div",{staticClass:"amount"},[t._v(t._s(t.totalPrice)+" 元")])]),r("div",{staticClass:"row col-lg-8"},[r("div",{staticClass:"col"},[t._v("運費:")]),r("div",{staticClass:"amount"},[t._v(t._s(t.shippingFee)+" 元")])]),r("div",{staticClass:"row col-lg-8"},[r("div",{staticClass:"col"},[t._v("折價券折抵:")]),t.coupon?r("div",{staticClass:"amount"},[t._v("- "+t._s(t.coupon.discount)+" 元")]):r("div",{staticClass:"amount",staticStyle:{float:"right"}},[t._v("0 元")])]),r("div",{staticClass:"row col-lg-8"},[r("div",{staticClass:"col"},[t._v("金額總計:")]),t.coupon?r("div",{staticClass:"amount"},[t._v(t._s(t.subtotal-t.coupon.discount)+" 元")]):r("div",{staticClass:"amount",staticStyle:{float:"right"}},[t._v(t._s(t.subtotal)+" 元")])])])},s=[],n=(r("c5f6"),{props:{coupon:{type:Object},totalPrice:{type:Number,default:-1},shippingFee:{type:Number,default:-1},subtotal:{type:Number,default:-1}}}),o=n,c=(r("5d80"),r("2877")),i=Object(c["a"])(o,a,s,!1,null,"d805a62a",null);e["a"]=i.exports},"996c":function(t,e,r){"use strict";var a=r("c99c"),s=r.n(a);s.a},ab31:function(t,e,r){"use strict";var a=r("2fa3");e["a"]={checkCoupon:function(t){var e=t.couponCode;return a["b"].post("/checkCoupon",{couponCode:e})},getCouponOrderEdit:function(t){var e=t.couponId;return a["b"].get("/couponOrder/".concat(e),{couponId:e})}}},b789:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container mb-5"},[t.isLoading?r("Spinner"):[r("div",{staticClass:"cart-box row"},[r("div",{staticClass:"row step col-12"},[r("div",{staticClass:"col-3 text-center step-point-line step-point"},[r("span",{staticClass:"step-by-step bg-dark rounded-pill text-light d-inline-block"},[t._v("Step 1")]),r("p",{staticClass:"step-text text-dark"},[t._v("確認購物車")])]),r("div",{staticClass:"arrow col-1"},[r("i",{staticClass:"fas fa-long-arrow-alt-right"})]),r("div",{staticClass:"col-3 text-center"},[r("span",{staticClass:"step-by-step border bg-secondary rounded-pill text-dark d-inline-block"},[t._v("Step 2")]),r("p",{staticClass:"step-text text-dark"},[t._v("付款與運送方式")])]),r("div",{staticClass:"arrow col-1",staticStyle:{color:"gray"}},[r("i",{staticClass:"fas fa-long-arrow-alt-right"})]),r("div",{staticClass:"col-3 text-center"},[r("span",{staticClass:"step-by-step border bg-secondary rounded-pill text-dark d-inline-block"},[t._v("Step 3")]),r("p",{staticClass:"step-text text-dark"},[t._v("成立訂單")])])])]),r("div",{staticClass:"cartNav row text-white col-12 mt-3"},[r("h3",[t._v(" 購物車明細")])]),this.items.length>0?r("CartItems",{attrs:{items:t.items}}):[r("div",{staticClass:"alert mt-3 col-12",attrs:{role:"alert"}},[t._v("您的購物車是空的!!")]),r("router-link",{staticClass:"btn btn-success shopping-btn mt-1 col-12",attrs:{to:"/"}},[t._v("繼續購物")])],this.items.length>0?r("UseCoupon",{attrs:{"total-price":t.totalPrice}}):t._e(),this.items.length>0?r("hr"):t._e(),this.items.length>0?r("CartAmount",{attrs:{coupon:t.coupon,"total-price":t.totalPrice,"shipping-fee":t.shippingFee,subtotal:t.subtotal}}):t._e(),this.items.length>0?r("div",{staticClass:"row mb-5"},[t.isAuthenticated?[r("p",{staticClass:"col"},[t._v(" ")]),t.coupon?r("router-link",{staticClass:"btn btn-success mt-4",attrs:{to:{name:"CouponOrder",params:{id:t.coupon.id}}}},[t._v("前往選擇付款及運送方式")]):r("router-link",{staticClass:"btn btn-success mt-4",attrs:{to:"/orderEdit"}},[t._v("前往選擇付款及運送方式")])]:[r("p",{staticClass:"col"},[t._v(" ")]),r("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.handlePrompt(e)}}},[r("router-link",{staticClass:"btn btn-success mt-4",attrs:{to:"/users/logIn?redirect=cart"}},[t._v("前往選擇付款及運送方式")])],1)]],2):t._e()]],2)},s=[],n=(r("8e6e"),r("ac6a"),r("456d"),r("96cf"),r("3b8d")),o=r("bd86"),c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("table",{staticClass:"table col-12"},[t._m(0),r("tbody",t._l(t.items,(function(e){return r("tr",{key:e.id},[r("td",[r("div",{staticStyle:{display:"flow-root"}},[r("img",{staticClass:"card-img",attrs:{src:e.image,alt:e.name}}),r("span",{staticClass:"item-name"},[t._v(t._s(e.name))])])]),r("td",[r("p",{staticClass:"price mt-2"},[r("span",{staticClass:"money-symbol"},[t._v("$")]),t._v("\n          "+t._s(e.price)+"\n        ")])]),r("td",[r("div",{staticClass:"qyt-select",staticStyle:{display:"flex"}},[r("button",{staticClass:"btn btn-sm btn-outline-secondary mt-1",attrs:{type:"button"},on:{click:function(r){return r.stopPropagation(),r.preventDefault(),t.subCartItemFrom(e.Cart_item.id)}}},[r("i",{staticClass:"fas fa-minus"})]),r("span",{staticClass:"quantity mt-2"},[t._v(t._s(e.Cart_item.quantity))]),r("button",{staticClass:"btn btn-sm btn-outline-secondary mt-1",attrs:{type:"button",disabled:t.overCount},on:{click:function(r){return r.stopPropagation(),r.preventDefault(),t.addCartItemFrom(e.Cart_item.id,e.count,e.Cart_item.quantity)}}},[r("i",{staticClass:"fas fa-plus"})])])]),r("td",[r("p",{staticClass:"Subtotal"},[r("span",{staticClass:"money-symbol"},[t._v("$")]),t._v("\n          "+t._s(e.price*e.Cart_item.quantity)+"\n        ")])]),r("td",[r("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(r){return r.stopPropagation(),r.preventDefault(),t.deleteCartItemFrom(e.Cart_item.id,e.Cart_item.quantity)}}},[r("i",{staticClass:"fas fa-trash",staticStyle:{color:"#0085a5"}})])])])})),0)])},i=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",[r("th",[t._v("商品")]),r("th",[t._v("價格")]),r("th",{staticClass:"qty-th"},[t._v("數量")]),r("th",[t._v("小計")]),r("th",[t._v("刪除")])])])}],u=(r("c5f6"),r("cc17")),l=r("2fa3"),p={inject:["reload"],props:{items:{type:Array,required:!0}},data:function(){return{overCount:!1}},methods:{subCartItemFrom:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var r,a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u["a"].subCartItem({cartItemId:e});case 3:if(r=t.sent,a=r.data,s=r.statusText,"OK"===s&&"success"===a.status){t.next=8;break}throw new Error(s);case 8:n=Number(localStorage.getItem("cartItemNumber")),n>0&&(n-=1,localStorage.setItem("cartItemNumber",n)),this.$store.commit("setCartItemNumber"),this.reload(),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0),l["a"].fire({type:"error",title:"無法刪減商品數量，請稍後再試"});case 17:case"end":return t.stop()}}),t,this,[[0,14]])})));function e(e){return t.apply(this,arguments)}return e}(),addCartItemFrom:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,r,a){var s,n,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,a!==r){t.next=5;break}return this.overCount=!0,l["a"].fire({type:"warning",title:"此商品已無額外庫存"}),t.abrupt("return");case 5:return t.next=7,u["a"].addCartItem({cartItemId:e});case 7:if(s=t.sent,n=s.data,o=s.statusText,"OK"===o&&"success"===n.status){t.next=12;break}throw new Error(o);case 12:c=Number(localStorage.getItem("cartItemNumber")),c++,localStorage.setItem("cartItemNumber",c),this.$store.commit("setCartItemNumber"),this.reload(),t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](0),l["a"].fire({type:"error",title:"無法增加商品數量，請稍後再試"});case 22:case"end":return t.stop()}}),t,this,[[0,19]])})));function e(e,r,a){return t.apply(this,arguments)}return e}(),deleteCartItemFrom:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,r){var a,s,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u["a"].deleteCartItem({cartItemId:e});case 3:if(a=t.sent,s=a.data,n=a.statusText,"OK"===n&&"success"===s.status){t.next=8;break}throw new Error(n);case 8:o=Number(localStorage.getItem("cartItemNumber")),o>0&&(o-=r,localStorage.setItem("cartItemNumber",o)),this.$store.commit("setCartItemNumber"),l["a"].fire({type:"success",title:"已成功移除商品"}),this.reload(),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),l["a"].fire({type:"error",title:"無法移除商品，請稍後再試"});case 18:case"end":return t.stop()}}),t,this,[[0,15]])})));function e(e,r){return t.apply(this,arguments)}return e}()}},d=p,m=(r("7a79"),r("2877")),b=Object(m["a"])(d,c,i,!1,null,"0e594e49",null),f=b.exports,v=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"coupon"},[r("hr"),r("form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"couponCode"}},[t._v("如果要使用折扣碼，請在此填入")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.coouponCode,expression:"coouponCode"}],staticClass:"form-control",attrs:{type:"text",id:"coouponCode",name:"couponCode",placeholder:"您的折價券序號"},domProps:{value:t.coouponCode},on:{input:function(e){e.target.composing||(t.coouponCode=e.target.value)}}}),r("div",{staticClass:"row"},[r("p",{staticClass:"col"},[t._v(" ")]),t.isAuthenticated?r("button",{staticClass:"btn btn-success mt-3 mr-2 mb-1",attrs:{type:"submit",disabled:t.isProcessing}},[t._v("使用折價券")]):r("router-link",{staticClass:"btn btn-success mt-3 mr-2 mb-1",attrs:{to:"/users/logIn?redirect=cart"}},[t._v("使用折價券")])],1)])])])},h=[],C=r("ab31"),g=r("2f62");function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(r,!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var w={props:{totalPrice:{type:Number,default:-1}},computed:_({},Object(g["b"])(["currentUser","isAuthenticated"])),data:function(){return{coouponCode:"",isProcessing:!1}},methods:{handleSubmit:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,r,a,s,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,this.isProcessing=!0,this.coouponCode){t.next=6;break}return l["a"].fire({type:"warning",title:"請輸入折價券序號"}),this.isProcessing=!1,t.abrupt("return");case 6:return t.next=8,C["a"].checkCoupon({couponCode:this.coouponCode});case 8:if(e=t.sent,r=e.data,a=e.statusText,s=r.couponId,n=r.available,o=r.discount,!1!==n){t.next=18;break}return l["a"].fire({type:"warning",title:"此序號已過期"}),this.isProcessing=!1,t.abrupt("return");case 18:if(!(o>this.totalPrice)){t.next=22;break}return l["a"].fire({type:"warning",title:"無法折抵超過您所消費的金額"}),this.isProcessing=!1,t.abrupt("return");case 22:if(s){t.next=26;break}return l["a"].fire({type:"warning",title:"此序號不存在"}),this.isProcessing=!1,t.abrupt("return");case 26:if("OK"===a&&"success"===r.status){t.next=28;break}throw new Error(a);case 28:l["a"].fire({type:"success",title:"已成功使用折價券"}),this.$router.push({path:"/cart",query:{couponId:s}}),this.isProcessing=!1,t.next=37;break;case 33:t.prev=33,t.t0=t["catch"](0),this.isProcessing=!1,l["a"].fire({type:"error",title:"無法使用折價券，請稍後再試"});case 37:case"end":return t.stop()}}),t,this,[[0,33]])})));function e(){return t.apply(this,arguments)}return e}()}},I=w,x=(r("996c"),Object(m["a"])(I,v,h,!1,null,"220d8efb",null)),O=x.exports,k=r("94e4"),P=r("2375");function j(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?j(r,!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var N={components:{CartItems:f,UseCoupon:O,CartAmount:k["a"],Spinner:P["a"]},data:function(){return{cart:{id:-1},totalPrice:-1,shippingFee:-1,subtotal:-1,items:[],coupon:{},isLoading:!1}},computed:S({},Object(g["b"])(["currentUser","isAuthenticated"])),beforeRouteUpdate:function(t,e,r){var a=t.query.couponId;this.fetchCart({couponId:a}),r()},created:function(){var t=this.$route.query.couponId;this.fetchCart({couponId:t})},methods:{fetchCart:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var r,a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.couponId,t.prev=1,this.isLoading=!0,t.next=5,u["a"].getCart({couponId:r});case 5:if(a=t.sent,s=a.data,n=a.statusText,"OK"===n){t.next=10;break}throw new Error(n);case 10:this.cart=s.cart,this.items=s.cart.items,this.totalPrice=s.totalPrice,this.shippingFee=s.shippingFee,this.subtotal=s.subtotal,this.coupon=s.coupon,this.isLoading=!1,t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](1),this.isLoading=!1,l["a"].fire({type:"error",title:"無法取得購物車資料，請稍後再試"});case 23:case"end":return t.stop()}}),t,this,[[1,19]])})));function e(e){return t.apply(this,arguments)}return e}(),handlePrompt:function(){l["a"].fire({type:"warning",title:"請先登入會員，即可繼續後續購物流程"})}}},E=N,q=(r("cfc2"),Object(m["a"])(E,a,s,!1,null,"38db1b7c",null));e["default"]=q.exports},c99c:function(t,e,r){},cc17:function(t,e,r){"use strict";r("6b54");var a=r("2fa3");e["a"]={postCart:function(t){var e=t.productId,r=t.quantity;return a["b"].post("/cart",{productId:e,quantity:r})},getCart:function(t){var e=t.couponId;if(e){var r=new URLSearchParams({couponId:e});return a["b"].get("/cart?".concat(r.toString()))}return a["b"].get("/cart")},addCartItem:function(t){var e=t.cartItemId;return a["b"].post("/cartItem/".concat(e,"/add"),{cartItemId:e})},subCartItem:function(t){var e=t.cartItemId;return a["b"].post("/cartItem/".concat(e,"/sub"),{cartItemId:e})},deleteCartItem:function(t){var e=t.cartItemId;return a["b"].delete("/cartItem/".concat(e),{cartItemId:e})}}},cfc2:function(t,e,r){"use strict";var a=r("d245"),s=r.n(a);s.a},d245:function(t,e,r){}}]);
//# sourceMappingURL=chunk-c804795e.8f0840f5.js.map